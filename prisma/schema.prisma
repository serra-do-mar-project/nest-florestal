generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model autoinfracao {
  id                Int              @id @default(autoincrement())
  data_emissao      DateTime         @db.Timestamp(6)
  cpf               String           @db.VarChar(11)
  id_exemplocaso    Int
  descricao         String
  relatoriodiarioId Int?
  fiscal            fiscal           @relation(fields: [cpf], references: [cpf], onDelete: Cascade)
  exemplocaso       exemplocaso      @relation(fields: [id_exemplocaso], references: [id], onDelete: Cascade)
  relatoriodiario   relatoriodiario? @relation(fields: [relatoriodiarioId], references: [id])

  @@index([cpf], map: "autoinfracao_cpf_fkey")
  @@index([id_exemplocaso], map: "autoinfracao_id_exemplocaso_fkey")
  @@index([relatoriodiarioId], map: "autoinfracao_relatoriodiarioId_fkey")
}

model exemplocaso {
  id              Int            @id @default(autoincrement())
  nome_resumo     String?        @db.VarChar(100)
  nome_completo   String         @db.VarChar(255)
  palavra_chave   String?        @db.VarChar(255)
  categoria       String         @db.VarChar(100)
  tipo_ocorrencia String?        @db.VarChar(100)
  tags            String?        @db.VarChar(255)
  proc_op         String
  proc_adm        String
  enq_pen         String
  enq_adm         String
  modelo          String         @db.Text
  campos          String?        @db.Text
  autoinfracao    autoinfracao[]
}

model fiscal {
  id              Int               @id @default(autoincrement())
  cpf             String            @unique
  nome            String
  senha           String
  tipo            tipo_usuario
  autoinfracao    autoinfracao[]
  relatoriodiario relatoriodiario[]
}

model relatoriodiario {
  id                               Int                  @id @default(autoincrement())
  equipe                           Equipe
  equipe_em_atuacao                String
  orgaos_e_instituicoes_envolvadas String
  responsavel                      String
  data_hora_inicio_acao            DateTime
  data_hora_termino_acao           DateTime
  origem                           Origem
  registro_ocorrencia              Boolean
  area_fiscalizada                 Boolean
  municipios                       Municipios
  setores                          Setores
  especificacao_local              String
  relatorio                        String
  outras_atividades                String
  cordenadas                       String
  placa_vtr                        String?
  km_inicio                        Int?
  km_final                         Int?
  condicoes_vtr                    String?
  tipo_acao                        TipoAcao
  descricao_veiculos               String?
  km_percorrido                    Int
  horas                            Int
  processado                       Boolean              @default(false)
  fiscalId                         Int
  tipo_veiculo_abordado            TipoVeiculoAbordado?
  veiculos_abordados               String?
  autoinfracao                     autoinfracao[]
  fiscal                           fiscal               @relation(fields: [fiscalId], references: [id])

  @@index([fiscalId], map: "relatoriodiario_fiscalId_fkey")
}

enum tipo_usuario {
  Campo
  Administrativo
  Admin
}

enum Equipe {
  charlie_sede_diurno
  charlie_rp_diurno
  charlie_rp_noturno
  delta_sede_diurno
  delta_rp_diurno
  delta_rp_noturno
}

enum Origem {
  rotina
  planejamento_SIMUC
  dejem_SIMUC
  denuncia
  atendimento_orgaos_externos
  demanda_soliitacao_inerna
}

enum Municipios {
  caraguatatuba
  paraibuna
  natividade_da_serra
}

enum Setores {
  caraguatatuba_norte
  caraguatatuba_sul
  alto_da_serra_norte
  alto_da_serra_sul
}

enum TipoAcao {
  incursao_viatura
  incrusao_pe
  fiscalizacao_embarcada
  sobrevoo
  fiscalizacao_drone
  bloqueio
}

enum TipoVeiculoAbordado {
  carro
  moto
  caminhao
  onibusVan
}
